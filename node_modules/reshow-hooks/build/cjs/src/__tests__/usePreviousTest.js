"use strict";

var _interopRequireWildcard = require("reshow-runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("reshow-runtime/helpers/interopRequireDefault");

var _classCallCheck2 = _interopRequireDefault(require("reshow-runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("reshow-runtime/helpers/createClass"));

var _assertThisInitialized2 = _interopRequireDefault(require("reshow-runtime/helpers/assertThisInitialized"));

var _inherits2 = _interopRequireDefault(require("reshow-runtime/helpers/inherits"));

var _createSuper2 = _interopRequireDefault(require("reshow-runtime/helpers/createSuper"));

var _defineProperty2 = _interopRequireDefault(require("reshow-runtime/helpers/defineProperty"));

var _react = _interopRequireWildcard(require("react"));

var _chai = require("chai");

var _reshowUnit = require("reshow-unit");

var _usePrevious = _interopRequireDefault(require("../usePrevious"));

describe("test usePrevious", function () {
  it("basic test", function () {
    var hackGlobal;

    var Foo = function Foo(props) {
      var prev = (0, _usePrevious["default"])(props.v);

      hackGlobal = function hackGlobal() {
        return {
          v: props.v,
          prev: prev
        };
      };

      return null;
    };

    var Comp = /*#__PURE__*/function (_Component) {
      (0, _inherits2["default"])(Comp, _Component);

      var _super = (0, _createSuper2["default"])(Comp);

      function Comp() {
        var _this;

        (0, _classCallCheck2["default"])(this, Comp);

        for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
          args[_key] = arguments[_key];
        }

        _this = _super.call.apply(_super, [this].concat(args));
        (0, _defineProperty2["default"])((0, _assertThisInitialized2["default"])(_this), "state", {
          v: null
        });
        return _this;
      }

      (0, _createClass2["default"])(Comp, [{
        key: "setV",
        value: function setV(v) {
          this.setState({
            v: v
          });
        }
      }, {
        key: "render",
        value: function render() {
          return /*#__PURE__*/_react["default"].createElement(Foo, {
            v: this.state.v
          });
        }
      }]);
      return Comp;
    }(_react.Component);

    var wrap = (0, _reshowUnit.mount)( /*#__PURE__*/_react["default"].createElement(Comp, null));
    (0, _chai.expect)(hackGlobal()).to.deep.equal({
      v: null,
      prev: undefined
    });
    wrap.instance().setV("bar");
    (0, _chai.expect)(hackGlobal()).to.deep.equal({
      v: "bar",
      prev: null
    });
  });
});