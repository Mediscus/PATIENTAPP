"use strict";

var _interopRequireDefault = require("reshow-runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "Map", {
  enumerable: true,
  get: function get() {
    return _immutable.Map;
  }
});
Object.defineProperty(exports, "Set", {
  enumerable: true,
  get: function get() {
    return _immutable.Set;
  }
});
exports.mergeMap = exports["default"] = void 0;

var _slicedToArray2 = _interopRequireDefault(require("reshow-runtime/helpers/slicedToArray"));

var _immutable = require("immutable");

var _toJS2 = _interopRequireDefault(require("./toJS"));

var _reshowFluxBase = require("reshow-flux-base");

var ImmutableStore = function ImmutableStore(reduce) {
  var initState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : (0, _immutable.Map)();

  var _createReducer = (0, _reshowFluxBase.createReducer)(reduce, initState),
      _createReducer2 = (0, _slicedToArray2["default"])(_createReducer, 2),
      store = _createReducer2[0],
      dispatch = _createReducer2[1];

  store.getMap = function (k) {
    return getMap(store.getState(), k);
  };

  return [store, dispatch];
};

var getMap = function getMap(state, k) {
  var _toJS;

  return (_toJS = (0, _toJS2["default"])(state.get(k))) !== null && _toJS !== void 0 ? _toJS : {};
};

var mergeMap = function mergeMap(state, JSArray) {
  return state.merge((0, _immutable.fromJS)(JSArray));
};

exports.mergeMap = mergeMap;
var _default = ImmutableStore;
exports["default"] = _default;